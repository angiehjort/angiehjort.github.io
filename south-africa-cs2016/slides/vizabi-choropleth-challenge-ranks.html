<html>

<head>
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/ >
  <link rel="stylesheet" href="../lib/vizabi/build/dist/vizabi.css">
  <script src="../lib/d3.v3.min.js"></script>
  <script src="../lib/vizabi/build/dist/vizabi.js"></script>
  <style>
    .vzb-tool.vzb-large.vzb-dialog-expand-true .vzb-tool-sidebar .vzb-tool-dialogs{
      background-color: transparent
    }
    .vzb-tool.vzb-large.vzb-dialog-expand-true .vzb-tool-dialogs>.vzb-dialogs-dialog.vzb-sidebar {
      background-color: transparent;
      border-bottom: none;
      border-top: none;
      padding-top: 80px;
    }
    .vzb-tool-stage{ 
      position: absolute; width: 100%; height: 100%; top: 0px; left: 0px;
    }
    .vzb-tool.vzb-large.vzb-dialog-expand-true .vzb-tool-dialogs>.vzb-dialogs-dialog.vzb-sidebar .vzb-dialog-title{
      display: none;
    }
  
  </style>
  
</head>

<body onkeyup="parent.keyCode(event)">
  <div id='placeholder' style='position: absolute; top: 0; bottom: 0; left: 0; right: 0; height: 100%; width: 100%;'></div>
  <script>

//  d3.csv("../data/ddf--datapoints--challenge_rank--by--municipality--challenge.csv", function(r){
//    var result = {};
//    r.forEach(function(d){
//      if(!result[d.geo]) {
//        result[d.geo] = {time: 2016, geo: d.geo};
//      }
//      result[d.geo]["ch"+d.challenge] = d.challenge_rank;
//      if(d.challenge_rank=="1")result[d.geo]["top_ch"] = "ch"+d.challenge;
//      
//    })
//    
//    var pushed = [];
//    Object.keys(result).forEach(function(d){
//      pushed.push(result[d]);
//    })
//    
//    console.table(pushed);
//  })
    
  var locationArray = window.location.href.split("/");
  var localUrl = locationArray.splice(0, locationArray.indexOf("slides")).join("/")+"/";
      
  Vizabi._globals.ext_resources = {
    host: localUrl,
    translationPath: localUrl + 'dictionaries/zaf/en.json',
    conceptpropsPath: localUrl + 'dictionaries/zaf/metadata.json',
    shapePath: localUrl + 'maps/municipalities.json'
  };

  Vizabi('Cartogram', document.getElementById('placeholder'), {
    state: {      
      marker: {
        color: {
          which: parent.getParamValue("which", window) || "ch1"
        }
      }
    },
    data: {
      reader: "csv",
      path: "../data/ddf--datapoints--challenge_rank--by--municipality--challenge.csv",
      splash: false
    },
    ui: {
      presentation: true,
      buttons: ['colors'],
      dialogs: {
        'popup': ['colors'],
        'sidebar': ['colors'],
        'moreoptions': ['colors', 'about']
      }
    }
  });
    
  d3.select(".vzb-tool").classed("vzb-timeslider-off",true);
  d3.select(".vzb-ct-year").classed("vzb-hidden",true);
  d3.select(".vzb-data-warning").classed("vzb-hidden",true);
  
  d3.selectAll(".vzb-dialogs-dialog.vzb-sidebar").style("background-color","transparent")
  
  
  
    
  </script>
</body>

</html>