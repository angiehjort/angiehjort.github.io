<html>

<head>
  <link rel="stylesheet" href="lib/vizabi/build/dist/vizabi.css">
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="lib/vizabi/build/dist/vizabi.js"></script>
</head>

<body onkeyup="parent.keyCode(event)">
  <div id='placeholder' style='position: absolute; top: 0; bottom: 0; left: 0; right: 0; height: 100%; width: 100%;'></div>
  <script>
    
  var locationArray = window.location.href.split("/");
  var localUrl = locationArray.splice(0, locationArray.indexOf("preview")).join("/") + "/preview/";
      
  Vizabi._globals.ext_resources = {
      host: localUrl,
      preloadPath: 'data/zaf/',
      dataPath: 'data/zaf/waffles/',
      conceptpropsPath: localUrl + 'data/zaf/metadata.json',
      shapePath: localUrl + 'data/zaf/provinces.json'
    };
    
    
  Vizabi('Cartogram', document.getElementById('placeholder'), {
    state: {
      time: {
        value: "1996",
        start: "1996",
        end: "2011",
        startSelected: "1996",
        endSelected: "2011"
      },
      entities: {
        dim: "province",
        show: {
         _defs_: {
           "province.cat": ["province", "municipality"]
         }
        }
      },
      entities_minimap: {
        dim: "province",
        show: {
         _defs_: {
           "province.cat": ["province", "municipality"]
         }
        }
      },
      marker: {
        color: {
          scaleType: "log"
        },
        size: {
          use: "indicator",
          which: "zaf_population"
        },
        label: {
          which: "province.name"
        }
      },
      marker_minimap: {
        label: {
          which: "province.name"
        }
      }
    },
    data: {
      reader: "csv",
      path: "preview/data/ddf--datapoints--population--black_population--black_population_percentage--by--year--province.csv",
      splash: false
    },
    ui: {
      chart: {
        lockNonSelected: 1996,
        lockActive: 1
      },
      presentation: false,
      buttons: [],
      dialogs: {
        'popup': ['colors', 'find', 'size', 'moreoptions'], 
        'sidebar': ['colors', 'find', 'size'], 
        'moreoptions': ['size', 'colors', 'about']
      }
    }
  });
    
  d3.select(".vzb-data-warning").classed("vzb-hidden",true);
  </script>
</body>

</html>
